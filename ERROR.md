
[19:41:11.161] Running build in Washington, D.C., USA (East) – iad1
[19:41:11.170] Build machine configuration: 2 cores, 8 GB
[19:41:11.214] Cloning github.com/Mrbaeksang/team_sync_ai (Branch: main, Commit: 72e3452)
[19:41:11.700] Cloning completed: 485.000ms
[19:41:14.376] Restored build cache from previous deployment (F8EugbxDoRJZdqFTRnSRZqaaq8KB)
[19:41:15.215] Running "vercel build"
[19:41:15.666] Vercel CLI 44.2.10
[19:41:15.823] Detected OpenTelemetry dependency: @vercel/otel@1.12.0, which meets the minimum version requirement of 1.11.0
[19:41:16.169] Detected pnpm-lock.yaml version 9 generated by pnpm@10.x with package.json#packageManager pnpm@9.12.3
[19:41:16.203] Installing dependencies...
[19:41:18.748] Lockfile is up to date, resolution step is skipped
[19:41:18.858] Already up to date
[19:41:19.732] 
[19:41:19.785] Done in 1.5s
[19:41:19.806] Detected Next.js version: 15.3.0-canary.31
[19:41:19.826] Running "pnpm run build"
[19:41:20.517] 
[19:41:20.518] > ai-chatbot@3.1.0 build /vercel/path0
[19:41:20.518] > tsx lib/db/migrate && next build
[19:41:20.518] 
[19:41:22.414] ⏳ Running migrations...
[19:41:24.832] {
[19:41:24.832]   severity_local: 'NOTICE',
[19:41:24.832]   severity: 'NOTICE',
[19:41:24.832]   code: '42P06',
[19:41:24.832]   message: 'schema "drizzle" already exists, skipping',
[19:41:24.832]   file: 'schemacmds.c',
[19:41:24.832]   line: '132',
[19:41:24.832]   routine: 'CreateSchemaCommand'
[19:41:24.833] }
[19:41:25.052] {
[19:41:25.053]   severity_local: 'NOTICE',
[19:41:25.053]   severity: 'NOTICE',
[19:41:25.053]   code: '42P07',
[19:41:25.053]   message: 'relation "__drizzle_migrations" already exists, skipping',
[19:41:25.053]   file: 'parse_utilcmd.c',
[19:41:25.053]   line: '207',
[19:41:25.053]   routine: 'transformCreateStmt'
[19:41:25.053] }
[19:41:25.744] ✅ Migrations completed in 3319 ms
[19:41:27.227]    ▲ Next.js 15.3.0-canary.31
[19:41:27.228]    - Experiments (use with caution):
[19:41:27.229]      ✓ ppr
[19:41:27.229] 
[19:41:27.261]    Creating an optimized production build ...
[19:41:56.010]  ✓ Compiled successfully
[19:41:56.018]    Linting and checking validity of types ...
[19:42:22.541] 
[19:42:22.541] ./app/projects/[id]/dashboard/page.tsx
[19:42:22.541] 4:43  Warning: '/vercel/path0/lib/db/schema.ts' imported multiple times.  import/no-duplicates
[19:42:22.541] 8:32  Warning: '/vercel/path0/lib/db/schema.ts' imported multiple times.  import/no-duplicates
[19:42:22.541] 
[19:42:22.541] info  - Need to disable some ESLint rules? Learn more here: https://nextjs.org/docs/app/api-reference/config/eslint#disabling-rules
[19:42:27.230] Failed to compile.
[19:42:27.230] 
[19:42:27.232] app/(chat)/chat/[id]/page.tsx
[19:42:27.232] Type error: Type '{ params: { id: string; }; }' does not satisfy the constraint 'PageProps'.
[19:42:27.233]   Types of property 'params' are incompatible.
[19:42:27.233]     Type '{ id: string; }' is missing the following properties from type 'Promise<any>': then, catch, finally, [Symbol.toStringTag]
[19:42:27.233] 
[19:42:27.275] Next.js build worker exited with code: 1 and signal: null
[19:42:27.284]  ELIFECYCLE  Command failed with exit code 1.
[19:42:27.306] Error: Command "pnpm run build" exited with 1
[19:42:27.802] 
[19:42:30.618] Exiting build container


ChatGPT의 말:
🚨 빌드 실패 원인 요약 (Next.js 15, params Promise 이슈)

1️⃣ 에러 메시지
pgsql
복사
편집
Type error: Type '{ params: { id: string; }; }' does not satisfy the constraint 'PageProps'.
Types of property 'params' are incompatible.
  Type '{ id: string; }' is missing the following properties from type 'Promise<any>': then, catch, finally, [Symbol.toStringTag]
서버 컴포넌트 동적 라우트에서 params가 Promise로 전달됨!

{ params: { id: string } } → ❌
{ params: Promise<{ id: string }> } → ⭕

그리고 내부에서 반드시 const { id } = React.use(params) 형태로 언래핑해야 함

2️⃣ 고쳐야 할 코드 (예시)
변경 전 (문제 코드)
tsx
복사
편집
// app/(chat)/chat/[id]/page.tsx
export default function ChatPage({ params }: { params: { id: string } }) {
  // ...
}
변경 후 (Next.js 15 호환 서버 컴포넌트)
tsx
복사
편집
import * as React from "react";

export default function ChatPage({ params }: { params: Promise<{ id: string }> }) {
  const { id } = React.use(params);
  // ...
}
3️⃣ 정리
서버 컴포넌트에서만 사용 가능

클라이언트 컴포넌트는 useParams 사용 ("use client")

4️⃣ 적용할 위치
app/(chat)/chat/[id]/page.tsx

app/projects/[id]/dashboard/page.tsx

app/projects/[id]/chat-room/page.tsx

그 외 [id] 등 param 사용하는 모든 서버 컴포넌트 페이지

5️⃣ 동일 파일 여러 번 import 관련 Warning
import ... from "@/lib/db/schema"; 같은 구문이 파일 여러 번 등장

한 번만 import 되도록 정리

✅ 빠른 적용 방법
해당 파일(예시)
tsx
복사
편집
// app/(chat)/chat/[id]/page.tsx
import * as React from "react";
import { Card, CardContent } from "@/components/ui/card";

export default function ChatPage({ params }: { params: Promise<{ id: string }> }) {
  const { id } = React.use(params);

  return (
    <div>
      <Card>
        <CardContent>
          <h1>채팅방 (ID: {id})</h1>
          {/* 기타 UI */}
        </CardContent>
      </Card>
    </div>
  );
}
